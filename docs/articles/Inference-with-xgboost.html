<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inference with xgboost • TidyConsultant</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Inference with xgboost">
<meta property="og:description" content="TidyConsultant">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VPS4SG2YRY"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VPS4SG2YRY');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TidyConsultant</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/TidyConsultant.html">Get started</a>
</li>
<li>
  <a href="../articles/Inference-with-xgboost.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Harrison4192/TidyConsultant" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://linkedin.com/in/harrison-tietze-204b5366" class="external-link">
    <span class="fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/Harri_Boi_R" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Inference-with-xgboost_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="Inference-with-xgboost_files/viz-1.8.2/viz.js"></script><link href="Inference-with-xgboost_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="Inference-with-xgboost_files/grViz-binding-1.0.9/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Inference with xgboost</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Harrison4192/TidyConsultant/blob/HEAD/vignettes/articles/Inference-with-xgboost.Rmd" class="external-link"><code>vignettes/articles/Inference-with-xgboost.Rmd</code></a></small>
      <div class="hidden name"><code>Inference-with-xgboost.Rmd</code></div>

    </div>

    
    
<p>This article contains a workflow in R to analyze a data set using
xgboost to get insights that can help a consultant make important
business decisions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman" class="external-link">pacman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ModelOriented/EIX" class="external-link">EIX</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://harrison4192.github.io/validata/" class="external-link">validata</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html" class="external-link">p_load</a></span><span class="op">(</span><span class="va">TidyConsultant</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="inspect-data-set">Inspect data set<a class="anchor" aria-label="anchor" href="#inspect-data-set"></a>
</h2>
<p>We will use the HR_data from the EIX package. Let’s inspect the
variables using the validata package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span></span>
<span><span class="co">#&gt;        satisfaction_level last_evaluation number_project average_montly_hours</span></span>
<span><span class="co">#&gt;     1:               0.38            0.53              2                  157</span></span>
<span><span class="co">#&gt;     2:               0.80            0.86              5                  262</span></span>
<span><span class="co">#&gt;     3:               0.11            0.88              7                  272</span></span>
<span><span class="co">#&gt;     4:               0.72            0.87              5                  223</span></span>
<span><span class="co">#&gt;     5:               0.37            0.52              2                  159</span></span>
<span><span class="co">#&gt;    ---                                                                       </span></span>
<span><span class="co">#&gt; 14995:               0.40            0.57              2                  151</span></span>
<span><span class="co">#&gt; 14996:               0.37            0.48              2                  160</span></span>
<span><span class="co">#&gt; 14997:               0.37            0.53              2                  143</span></span>
<span><span class="co">#&gt; 14998:               0.11            0.96              6                  280</span></span>
<span><span class="co">#&gt; 14999:               0.37            0.52              2                  158</span></span>
<span><span class="co">#&gt;        time_spend_company Work_accident left promotion_last_5years   sales</span></span>
<span><span class="co">#&gt;     1:                  3             0    1                     0   sales</span></span>
<span><span class="co">#&gt;     2:                  6             0    1                     0   sales</span></span>
<span><span class="co">#&gt;     3:                  4             0    1                     0   sales</span></span>
<span><span class="co">#&gt;     4:                  5             0    1                     0   sales</span></span>
<span><span class="co">#&gt;     5:                  3             0    1                     0   sales</span></span>
<span><span class="co">#&gt;    ---                                                                    </span></span>
<span><span class="co">#&gt; 14995:                  3             0    1                     0 support</span></span>
<span><span class="co">#&gt; 14996:                  3             0    1                     0 support</span></span>
<span><span class="co">#&gt; 14997:                  3             0    1                     0 support</span></span>
<span><span class="co">#&gt; 14998:                  4             0    1                     0 support</span></span>
<span><span class="co">#&gt; 14999:                  3             0    1                     0 support</span></span>
<span><span class="co">#&gt;        salary</span></span>
<span><span class="co">#&gt;     1:    low</span></span>
<span><span class="co">#&gt;     2: medium</span></span>
<span><span class="co">#&gt;     3: medium</span></span>
<span><span class="co">#&gt;     4:    low</span></span>
<span><span class="co">#&gt;     5:    low</span></span>
<span><span class="co">#&gt;    ---       </span></span>
<span><span class="co">#&gt; 14995:    low</span></span>
<span><span class="co">#&gt; 14996:    low</span></span>
<span><span class="co">#&gt; 14997:    low</span></span>
<span><span class="co">#&gt; 14998:    low</span></span>
<span><span class="co">#&gt; 14999:    low</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://harrison4192.github.io/validata/reference/diagnose_category.html" class="external-link">diagnose_category</a></span><span class="op">(</span>max_distinct <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 4</span></span></span>
<span><span class="co">#&gt;    column level           n  ratio</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> sales  sales        <span style="text-decoration: underline;">4</span>140 0.276 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> sales  technical    <span style="text-decoration: underline;">2</span>720 0.181 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> sales  support      <span style="text-decoration: underline;">2</span>229 0.149 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> sales  IT           <span style="text-decoration: underline;">1</span>227 0.081<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> sales  product_mng   902 0.060<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> sales  marketing     858 0.057<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> sales  RandD         787 0.052<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> sales  accounting    767 0.051<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> sales  hr            739 0.049<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> sales  management    630 0.042<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> salary low          <span style="text-decoration: underline;">7</span>316 0.488 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> salary medium       <span style="text-decoration: underline;">6</span>446 0.430 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> salary high         <span style="text-decoration: underline;">1</span>237 0.082<span style="text-decoration: underline;">5</span></span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://harrison4192.github.io/validata/reference/diagnose_numeric.html" class="external-link">diagnose_numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 11</span></span></span>
<span><span class="co">#&gt;   variables zeros minus  infs   min    mean   max |x|&lt;1…¹ integ…²   mode mode_…³</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> satisfac…     0     0     0  0.09 6.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1   0.993 0.007<span style="text-decoration: underline;">40</span>   0.1   0.023<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> last_eva…     0     0     0  0.36 7.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1   0.981 0.018<span style="text-decoration: underline;">9</span>    0.55  0.023<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> number_p…     0     0     0  2    3.80<span style="color: #949494;">e</span>+0     7   0     1         4     0.291 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> average_…     0     0     0 96    2.01<span style="color: #949494;">e</span>+2   310   0     1       135     0.010<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> time_spe…     0     0     0  2    3.50<span style="color: #949494;">e</span>+0    10   0     1         3     0.430 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Work_acc… <span style="text-decoration: underline;">12</span>830     0     0  0    1.45<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1   0.855 1         0     0.855 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> left      <span style="text-decoration: underline;">11</span>428     0     0  0    2.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1   0.762 1         0     0.762 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> promotio… <span style="text-decoration: underline;">14</span>680     0     0  0    2.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>     1   0.979 1         0     0.979 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable names ¹​`|x|&lt;1 (ratio)`, ²​integer_ratio,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ³​mode_ratio</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="xgboost-binary-classification-model">xgboost binary classification model<a class="anchor" aria-label="anchor" href="#xgboost-binary-classification-model"></a>
</h2>
<p>Create dummy variables out of the Sales and Salary column. We will
predict whether an employee left the company using xgboost. For this
reason, set <code>left = 1</code> to the first level of the factor, so
it will be treated as the event class. A high predicted indicates a
label of the event class.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">framecleaner</span><span class="fu">::</span><span class="fu"><a href="https://harrison4192.github.io/framecleaner/reference/create_dummies.html" class="external-link">create_dummies</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">framecleaner</span><span class="fu">::</span><span class="fu"><a href="https://harrison4192.github.io/framecleaner/reference/set_fct.data.frame.html" class="external-link">set_fct</a></span><span class="op">(</span><span class="va">left</span>, first_level <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hr1</span></span></code></pre></div>
<p>Create the model using xgboost. Since the goal of this model is to
run inference using trees, we want to set tree_depth to 2 to make
easily-interpretable trees.</p>
<p>When the model is run, feature importance on the full data is
printed. Also the data is split into train and test, where the accuracy
is calculated on a test set. Since this is a binary classification
problem, a confusion matrix is output along with binary metrics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidy_formula</span><span class="op">(</span><span class="va">left</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hrf</span></span>
<span></span>
<span><span class="va">hr1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidy_xgboost</span><span class="op">(</span><span class="va">hrf</span>, tree_depth <span class="op">=</span> <span class="fl">2L</span>, trees <span class="op">=</span> <span class="fl">100L</span>, mtry <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">xg1</span></span></code></pre></div>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 3</span></span></span>
<span><span class="co">#&gt;    .metric              .estimate .formula              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> accuracy                 0.975 TP + TN / total       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> kap                      0.930 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> sens                     0.931 TP / actually P       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> spec                     0.989 TN / actually N       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ppv                      0.963 TP / predicted P      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> npv                      0.978 TN / predicted N      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mcc                      0.930 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> j_index                  0.920 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> bal_accuracy             0.960 sens + spec / 2       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> detection_prevalence     0.231 predicted P / total   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> precision                0.963 PPV, 1-FDR            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> recall                   0.931 sens, TPR             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> f_meas                   0.947 HM(ppv, sens)         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> baseline_accuracy        0.761 majority class / total</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> roc_auc                  0.987 <span style="color: #BB0000;">NA</span></span></span></code></pre>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>This line will save the tree structure of the model as a table.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xg1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.model.dt.tree.html" class="external-link">xgb.model.dt.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">.</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">xg_trees</span></span>
<span></span>
<span><span class="va">xg_trees</span></span>
<span><span class="co">#&gt;      Tree Node   ID            Feature Split  Yes   No Missing       Quality</span></span>
<span><span class="co">#&gt;   1:    0    0  0-0 satisfaction_level 0.465  0-1  0-2     0-1 3123.25146000</span></span>
<span><span class="co">#&gt;   2:    0    1  0-1     number_project 2.500  0-3  0-4     0-3  892.94714400</span></span>
<span><span class="co">#&gt;   3:    0    2  0-2 time_spend_company 4.500  0-5  0-6     0-5 1284.82617000</span></span>
<span><span class="co">#&gt;   4:    0    3  0-3               Leaf    NA &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;    0.45360827</span></span>
<span><span class="co">#&gt;   5:    0    4  0-4               Leaf    NA &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;   -0.10822086</span></span>
<span><span class="co">#&gt;  ---                                                                        </span></span>
<span><span class="co">#&gt; 614:   99    2 99-2     number_project 2.500 99-5 99-6    99-5   28.99409870</span></span>
<span><span class="co">#&gt; 615:   99    3 99-3               Leaf    NA &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;    0.07221178</span></span>
<span><span class="co">#&gt; 616:   99    4 99-4               Leaf    NA &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;   -0.13327244</span></span>
<span><span class="co">#&gt; 617:   99    5 99-5               Leaf    NA &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;   -0.26394776</span></span>
<span><span class="co">#&gt; 618:   99    6 99-6               Leaf    NA &lt;NA&gt; &lt;NA&gt;    &lt;NA&gt;    0.05643456</span></span>
<span><span class="co">#&gt;           Cover</span></span>
<span><span class="co">#&gt;   1: 3749.75000</span></span>
<span><span class="co">#&gt;   2: 1045.75000</span></span>
<span><span class="co">#&gt;   3: 2704.00000</span></span>
<span><span class="co">#&gt;   4:  435.50000</span></span>
<span><span class="co">#&gt;   5:  610.25000</span></span>
<span><span class="co">#&gt;  ---           </span></span>
<span><span class="co">#&gt; 614:  256.00961</span></span>
<span><span class="co">#&gt; 615:  110.06954</span></span>
<span><span class="co">#&gt; 616:  101.18491</span></span>
<span><span class="co">#&gt; 617:   27.59598</span></span>
<span><span class="co">#&gt; 618:  228.41362</span></span></code></pre></div>
<p>Let’s plot the first tree and interpret the table output. For tree=0,
the root feature (node=0) is satisfaction level, which is split at value
.465. Is satisfaction_level &lt; .465? If Yes, observations go left to
node 1, if no, observations go right to node 2. Na values would go to
node 1 if present. The quality of the split is represented by its Gain:
3123, the improvement in training loss.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.plot.tree.html" class="external-link">xgb.plot.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">xg1</span>, trees <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-ffb885c2af096ba53226" style="width:700px;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-ffb885c2af096ba53226">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 0\nsatisfaction_level\nCover: 3749.75\nGain: 3123.25146\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"2\" [label = \"number_project\nCover: 1045.75\nGain: 892.947144\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"3\" [label = \"time_spend_company\nCover: 2704\nGain: 1284.82617\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"4\" [label = \"Leaf\nCover: 435.5\nValue: 0.453608274\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"5\" [label = \"Leaf\nCover: 610.25\nValue: -0.10822086\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"6\" [label = \"Leaf\nCover: 2208.5\nValue: -0.582349002\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"7\" [label = \"Leaf\nCover: 495.5\nValue: -0.0477341413\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n\"1\"->\"2\" [label = \"< 0.465000004\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 2.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 4.5\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>The quality in the leaves is the prediction for observations in those
leaves represented by log odds. To interpret them as probabilities, use
the function below. Importantly, a log odds of 0 is a 0.5
probability.</p>
<div class="figure">
<img src="sigmoidfunction.png" alt=""><p class="caption">sigmoid curve: logit function</p>
</div>
</div>
<div class="section level2">
<h2 id="analyze-interactions">Analyze interactions<a class="anchor" aria-label="anchor" href="#analyze-interactions"></a>
</h2>
<p>In xgboost, an interaction occurs when the downstream split has a
higher gain than the upstream split.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># write the function collapse_tree to convert the tree output to interactions that occur in the tree.</span></span>
<span></span>
<span><span class="va">collapse_tree</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t1</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="va">t1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Tree</span>,  Root_Feature <span class="op">=</span> <span class="va">Feature</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span></span>
<span>    <span class="va">t1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Child1 <span class="op">=</span> <span class="va">Feature</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span></span>
<span>    <span class="va">t1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Child2 <span class="op">=</span> <span class="va">Feature</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"interaction1"</span>, <span class="va">Root_Feature</span>, <span class="va">Child1</span>, sep <span class="op">=</span> <span class="st">":"</span>, remove <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Child1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"interaction2"</span>, <span class="va">Root_Feature</span>, <span class="va">Child2</span>, sep <span class="op">=</span> <span class="st">":"</span>, remove <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"names"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"interaction"</span><span class="op">)</span>, values_to <span class="op">=</span> <span class="st">"interactions"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">xg_trees</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">collapse_tree</span> <span class="op">-&gt;</span> <span class="va">xg_trees_interactions</span></span></code></pre></div>
<p>find the top interactions in the model. The interactions are rated
with different importance metrics, ordered by sumGain.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">imps</span> <span class="op">&lt;-</span> <span class="fu">EIX</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EIX/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">xg1</span>, <span class="va">hr1</span>, option <span class="op">=</span> <span class="st">"interactions"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">imps</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">set_int</span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 7</span></span></span>
<span><span class="co">#&gt;    Feature                       sumGain sumCo…¹ meanG…² meanC…³ frequ…⁴ mean5…⁵</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> time_spend_company:satisfact…    <span style="text-decoration: underline;">1</span>941    <span style="text-decoration: underline;">4</span>734     485    <span style="text-decoration: underline;">1</span>184       4     485</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> average_montly_hours:number_…    <span style="text-decoration: underline;">1</span>666    <span style="text-decoration: underline;">5</span>943     333    <span style="text-decoration: underline;">1</span>189       5     333</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> last_evaluation:number_proje…     923    <span style="text-decoration: underline;">3</span>498     461    <span style="text-decoration: underline;">1</span>749       2     461</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> satisfaction_level:last_eval…     865    <span style="text-decoration: underline;">3</span>240     288    <span style="text-decoration: underline;">1</span>080       3     288</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> last_evaluation:average_mont…     784    <span style="text-decoration: underline;">1</span>692     392     846       2     392</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> satisfaction_level:time_spen…     645    <span style="text-decoration: underline;">2</span>703     107     450       6     128</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> average_montly_hours:time_sp…     332    <span style="text-decoration: underline;">2</span>170      55     361       6      64</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> last_evaluation:time_spend_c…     262     494     262     494       1     262</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> average_montly_hours:last_ev…     259    <span style="text-decoration: underline;">1</span>294      64     323       4      64</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> average_montly_hours:satisfa…     245    <span style="text-decoration: underline;">1</span>457      61     364       4      61</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 20 more rows, and abbreviated variable names ¹​sumCover, ²​meanGain,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ³​meanCover, ⁴​frequency, ⁵​mean5Gain</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span></span></code></pre></div>
<p>We can extract all the trees that contain the specified
interaction.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">imps</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unlist</span> <span class="op">-&gt;</span> <span class="va">top_interaction</span></span>
<span></span>
<span></span>
<span><span class="va">xg_trees_interactions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">interactions</span>, <span class="va">top_interaction</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="va">distinct</span> <span class="op">-&gt;</span> <span class="va">top_interaction_trees</span></span>
<span></span>
<span><span class="va">top_interaction_trees</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;    Tree interactions                         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     2 time_spend_company:satisfaction_level</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     7 time_spend_company:satisfaction_level</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    15 time_spend_company:satisfaction_level</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    28 time_spend_company:satisfaction_level</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    30 time_spend_company:satisfaction_level</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>    99 time_spend_company:satisfaction_level</span></span></code></pre></div>
<p>Then extract the first 3 (most important) trees and print them.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_interaction_trees</span><span class="op">$</span><span class="va">Tree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">trees_index</span></span>
<span></span>
<span></span>
<span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.plot.tree.html" class="external-link">xgb.plot.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">xg1</span>, trees <span class="op">=</span> <span class="va">trees_index</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-f0ff58fc9f6868587d26" style="width:700px;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-f0ff58fc9f6868587d26">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 15\ntime_spend_company\nCover: 1545.47266\nGain: 136.206497\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"2\" [label = \"satisfaction_level\nCover: 178.555542\nGain: 11.5646057\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"3\" [label = \"salary_low\nCover: 1366.91711\nGain: 107.790558\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"4\" [label = \"Leaf\nCover: 1.91654456\nValue: 0.357846916\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"5\" [label = \"Leaf\nCover: 176.638992\nValue: -0.262718469\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"6\" [label = \"Leaf\nCover: 667.448792\nValue: -0.0623873174\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"7\" [label = \"Leaf\nCover: 699.468262\nValue: 0.106029168\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"8\" [label = \"Tree 7\ntime_spend_company\nCover: 2077.79565\nGain: 248.450623\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"9\" [label = \"satisfaction_level\nCover: 305.51944\nGain: 9.88946533\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"10\" [label = \"satisfaction_level\nCover: 1772.27625\nGain: 295.521484\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"11\" [label = \"Leaf\nCover: 2.63560152\nValue: 0.210677996\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"12\" [label = \"Leaf\nCover: 302.88385\nValue: -0.312765062\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"13\" [label = \"Leaf\nCover: 727.124451\nValue: 0.131717369\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"14\" [label = \"Leaf\nCover: 1045.15173\nValue: -0.117184483\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"15\" [label = \"Tree 2\ntime_spend_company\nCover: 3281.63403\nGain: 511.188965\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"16\" [label = \"satisfaction_level\nCover: 677.611145\nGain: 13.1878662\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"17\" [label = \"satisfaction_level\nCover: 2604.02271\nGain: 1568.87842\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"18\" [label = \"Leaf\nCover: 2.85944271\nValue: 0.178683251\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"19\" [label = \"Leaf\nCover: 674.751709\nValue: -0.416075051\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"20\" [label = \"Leaf\nCover: 209.688934\nValue: 0.664069772\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"21\" [label = \"Leaf\nCover: 2394.33374\nValue: -0.189862788\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n\"1\"->\"2\" [label = \"< 2.5\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 0.145000011\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 0.5\", style = \"bold\"] \n\"8\"->\"9\" [label = \"< 2.5\", style = \"bold\"] \n\"9\"->\"11\" [label = \"< 0.145000011\", style = \"bold\"] \n\"10\"->\"13\" [label = \"< 0.465000004\", style = \"bold\"] \n\"15\"->\"16\" [label = \"< 2.5\", style = \"bold\"] \n\"16\"->\"18\" [label = \"< 0.145000011\", style = \"bold\"] \n\"17\"->\"20\" [label = \"< 0.114999995\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n\"8\"->\"10\" [style = \"solid\", style = \"solid\"] \n\"9\"->\"12\" [style = \"solid\", style = \"solid\"] \n\"10\"->\"14\" [style = \"solid\", style = \"solid\"] \n\"15\"->\"17\" [style = \"solid\", style = \"solid\"] \n\"16\"->\"19\" [style = \"solid\", style = \"solid\"] \n\"17\"->\"21\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>We can confirm they are interactions because the child leaf in the
interaction has higher split gain than the root leaf.</p>
</div>
<div class="section level2">
<h2 id="analyze-single-features">Analyze single features<a class="anchor" aria-label="anchor" href="#analyze-single-features"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># EIX package gives more detailed importances than the standard xgboost package</span></span>
<span><span class="va">imps_single</span> <span class="op">&lt;-</span> <span class="fu">EIX</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EIX/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">xg1</span>, <span class="va">hr1</span>, option <span class="op">=</span> <span class="st">"variables"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># choose the top feature</span></span>
<span><span class="va">imps_single</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unlist</span> <span class="op">-&gt;</span> <span class="va">feature1</span></span>
<span></span>
<span><span class="co"># get the top 3 rees of the most important feature. Less complicated than with interactions so</span></span>
<span><span class="co"># no need to write a separate function like collapse tree</span></span>
<span><span class="va">xg_trees</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Feature</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">feature1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="va">unlist</span> <span class="op">-&gt;</span> <span class="va">top_trees</span></span>
<span></span>
<span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.plot.tree.html" class="external-link">xgb.plot.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">xg1</span>, trees <span class="op">=</span> <span class="va">top_trees</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-6b4a3cc891c8c80cd543" style="width:700px;height:432.632880098888px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-6b4a3cc891c8c80cd543">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 4\nsatisfaction_level\nCover: 2704.01611\nGain: 782.655396\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"2\" [label = \"average_montly_hours\nCover: 189.346802\nGain: 4.21386719\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"3\" [label = \"number_project\nCover: 2514.66919\nGain: 675.319336\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"4\" [label = \"Leaf\nCover: 139.545578\nValue: 0.500842094\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"5\" [label = \"Leaf\nCover: 49.8012161\nValue: 0.374175489\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"6\" [label = \"Leaf\nCover: 526.730774\nValue: 0.140512392\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"7\" [label = \"Leaf\nCover: 1987.93848\nValue: -0.24131313\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"8\" [label = \"Tree 3\nsatisfaction_level\nCover: 3035.48242\nGain: 1107.59302\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"9\" [label = \"time_spend_company\nCover: 966.215454\nGain: 437.333862\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"10\" [label = \"time_spend_company\nCover: 2069.26685\nGain: 956.652588\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"11\" [label = \"Leaf\nCover: 791.118774\nValue: 0.219585985\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"12\" [label = \"Leaf\nCover: 175.096664\nValue: -0.303205639\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"13\" [label = \"Leaf\nCover: 1609.42163\nValue: -0.373250276\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"14\" [label = \"Leaf\nCover: 459.845337\nValue: 0.117143705\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"15\" [label = \"Tree 0\nsatisfaction_level\nCover: 3749.75\nGain: 3123.25146\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"16\" [label = \"number_project\nCover: 1045.75\nGain: 892.947144\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"17\" [label = \"time_spend_company\nCover: 2704\nGain: 1284.82617\", shape = \"rectangle\", fontcolor = \"black\", fillcolor = \"Beige\"] \n  \"18\" [label = \"Leaf\nCover: 435.5\nValue: 0.453608274\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"19\" [label = \"Leaf\nCover: 610.25\nValue: -0.10822086\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"20\" [label = \"Leaf\nCover: 2208.5\nValue: -0.582349002\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n  \"21\" [label = \"Leaf\nCover: 495.5\nValue: -0.0477341413\", shape = \"oval\", fontcolor = \"black\", fillcolor = \"Khaki\"] \n\"1\"->\"2\" [label = \"< 0.114999995\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 287.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 2.5\", style = \"bold\"] \n\"8\"->\"9\" [label = \"< 0.465000004\", style = \"bold\"] \n\"9\"->\"11\" [label = \"< 4.5\", style = \"bold\"] \n\"10\"->\"13\" [label = \"< 4.5\", style = \"bold\"] \n\"15\"->\"16\" [label = \"< 0.465000004\", style = \"bold\"] \n\"16\"->\"18\" [label = \"< 2.5\", style = \"bold\"] \n\"17\"->\"20\" [label = \"< 4.5\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n\"8\"->\"10\" [style = \"solid\", style = \"solid\"] \n\"9\"->\"12\" [style = \"solid\", style = \"solid\"] \n\"10\"->\"14\" [style = \"solid\", style = \"solid\"] \n\"15\"->\"17\" [style = \"solid\", style = \"solid\"] \n\"16\"->\"19\" [style = \"solid\", style = \"solid\"] \n\"17\"->\"21\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>By looking at the 3 most important splits for satisfaction_level we
can get a sense of how its splits affect the outcome.</p>
</div>
<div class="section level2">
<h2 id="shapley-values">shapley values<a class="anchor" aria-label="anchor" href="#shapley-values"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xg1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidy_shap</span><span class="op">(</span><span class="va">hr1</span>, form <span class="op">=</span> <span class="va">hrf</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hr_shaps</span></span>
<span></span>
<span><span class="va">hr_shaps</span></span>
<span><span class="co">#&gt; $shap_tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14,999 × 20</span></span></span>
<span><span class="co">#&gt;    satisfactio…¹ last_…² numbe…³ avera…⁴ time_…⁵ Work_…⁶ promo…⁷ sales…⁸ sales…⁹</span></span>
<span><span class="co">#&gt;            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1.91    0.420  1.32    0.984  -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">1</span>  0.113        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         0.287   0.535  0.183   0.613   1.65    0.102        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         5.51    0.248  3.76    0.128   0.113   0.040<span style="text-decoration: underline;">6</span>       0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         0.194   0.535  0.028<span style="text-decoration: underline;">0</span>  0.349   2.17    0.107        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         1.91    0.420  1.32    0.984  -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">1</span>  0.113        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         1.91    0.420  1.32    0.984  -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">1</span>  0.113        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         6.62   -<span style="color: #BB0000;">0.703</span>  0.054<span style="text-decoration: underline;">3</span>  0.017<span style="text-decoration: underline;">3</span>  0.055<span style="text-decoration: underline;">8</span>  0.045<span style="text-decoration: underline;">8</span>       0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>        -<span style="color: #BB0000;">0.154</span>   0.538  0.146   0.623   2.29    0.107        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         0.199   2.21   0.056<span style="text-decoration: underline;">7</span>  0.369   2.26    0.104        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>         1.91    0.420  1.32    0.984  -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">1</span>  0.113        0       0       0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 14,989 more rows, 11 more variables: sales_IT &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sales_management &lt;dbl&gt;, sales_marketing &lt;dbl&gt;, sales_product_mng &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sales_RandD &lt;dbl&gt;, sales_sales &lt;dbl&gt;, sales_support &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sales_technical &lt;dbl&gt;, salary_high &lt;dbl&gt;, salary_low &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   salary_medium &lt;dbl&gt;, and abbreviated variable names ¹​satisfaction_level,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ²​last_evaluation, ³​number_project, ⁴​average_montly_hours,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ⁵​time_spend_company, ⁶​Work_accident, ⁷​promotion_last_5years, …</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $shap_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;    name                      cor      var       sum sum_abs</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> satisfaction_level    -<span style="color: #BB0000;">0.668</span>  4.76     -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">354.</span>     <span style="text-decoration: underline;">23</span>838.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> time_spend_company     0.328  1.22     -<span style="color: #BB0000; text-decoration: underline;">7</span><span style="color: #BB0000;">864.</span>     <span style="text-decoration: underline;">14</span>622.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> average_montly_hours   0.348  1.52      -<span style="color: #BB0000;">183.</span>     <span style="text-decoration: underline;">10</span>695.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> number_project         0.040<span style="text-decoration: underline;">9</span> 0.690    -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">867.</span>      <span style="text-decoration: underline;">9</span>367.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> last_evaluation        0.391  0.733    -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">603.</span>      <span style="text-decoration: underline;">8</span>745.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Work_accident         -<span style="color: #BB0000;">0.989</span>  0.109     -<span style="color: #BB0000;">495.</span>      <span style="text-decoration: underline;">3</span>090.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> salary_low             0.995  0.042<span style="text-decoration: underline;">1</span>    -<span style="color: #BB0000;">195.</span>      <span style="text-decoration: underline;">3</span>064.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> salary_high           -<span style="color: #BB0000;">0.987</span>  0.042<span style="text-decoration: underline;">9</span>    -<span style="color: #BB0000;">263.</span>      <span style="text-decoration: underline;">1</span>468.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> sales_product_mng     -<span style="color: #BB0000;">0.963</span>  0.006<span style="text-decoration: underline;">91</span>     47.3      613.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> sales_technical        0.894  0.001<span style="text-decoration: underline;">23</span>    -<span style="color: #BB0000;">15.6</span>      372.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> sales_RandD           -<span style="color: #BB0000;">0.967</span>  0.002<span style="text-decoration: underline;">68</span>     -<span style="color: #BB0000;">0.303</span>    335.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> sales_IT              -<span style="color: #BB0000;">0.992</span>  0.000<span style="text-decoration: underline;">708</span>    -<span style="color: #BB0000;">3.97</span>     214.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> salary_medium          0.410  0.000<span style="text-decoration: underline;">412</span>   -<span style="color: #BB0000;">12.5</span>      125.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> promotion_last_5years <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> sales_accounting      <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> sales_hr              <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> sales_management      <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> sales_marketing       <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> sales_sales           <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> sales_support         <span style="color: #BB0000;">NA</span>      0            0          0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $swarmplot</span></span></code></pre></div>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scatterplots</span></span></code></pre>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $boxplots</span></span></code></pre>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="links">Links<a class="anchor" aria-label="anchor" href="#links"></a>
</h2>
<p><a href="https://modeloriented.github.io/EIX/articles/EIX.html" class="external-link">EIX
vignette using HR_data</a> <a href="https://xgboost.readthedocs.io/en/stable/tutorials/model.html" class="external-link">Introduction
to boosted trees</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Harrison Tietze.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
