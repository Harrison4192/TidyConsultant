<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inference with xgboost • TidyConsultant</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Inference with xgboost">
<meta property="og:description" content="TidyConsultant">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-VPS4SG2YRY"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-VPS4SG2YRY');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TidyConsultant</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/TidyConsultant.html">Get started</a>
</li>
<li>
  <a href="../articles/Inference-with-xgboost.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Harrison4192/TidyConsultant" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://linkedin.com/in/harrison-tietze-204b5366" class="external-link">
    <span class="fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/Harri_Boi_R" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><link href="Inference-with-xgboost_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Inference-with-xgboost_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="Inference-with-xgboost_files/viz-1.8.2/viz.js"></script><link href="Inference-with-xgboost_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="Inference-with-xgboost_files/grViz-binding-1.0.11/grViz.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Inference with xgboost</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Harrison4192/TidyConsultant/blob/HEAD/vignettes/articles/Inference-with-xgboost.Rmd" class="external-link"><code>vignettes/articles/Inference-with-xgboost.Rmd</code></a></small>
      <div class="hidden name"><code>Inference-with-xgboost.Rmd</code></div>

    </div>

    
    
<p>This article contains a workflow in R to analyze a data set using
xgboost to get insights that can help a consultant make important
business decisions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>warning <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trinker/pacman" class="external-link">pacman</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ModelOriented/EIX" class="external-link">EIX</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://harrison4192.github.io/validata/" class="external-link">validata</a></span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html" class="external-link">p_load</a></span><span class="op">(</span><span class="va">TidyConsultant</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="inspect-data-set">Inspect data set<a class="anchor" aria-label="anchor" href="#inspect-data-set"></a>
</h2>
<p>We will use the HR_data from the EIX package. Let’s inspect the
variables using the validata package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span></span>
<span><span class="co">#&gt;        satisfaction_level last_evaluation number_project average_montly_hours</span></span>
<span><span class="co">#&gt;                     &lt;num&gt;           &lt;num&gt;          &lt;int&gt;                &lt;int&gt;</span></span>
<span><span class="co">#&gt;     1:               0.38            0.53              2                  157</span></span>
<span><span class="co">#&gt;     2:               0.80            0.86              5                  262</span></span>
<span><span class="co">#&gt;     3:               0.11            0.88              7                  272</span></span>
<span><span class="co">#&gt;     4:               0.72            0.87              5                  223</span></span>
<span><span class="co">#&gt;     5:               0.37            0.52              2                  159</span></span>
<span><span class="co">#&gt;    ---                                                                       </span></span>
<span><span class="co">#&gt; 14995:               0.40            0.57              2                  151</span></span>
<span><span class="co">#&gt; 14996:               0.37            0.48              2                  160</span></span>
<span><span class="co">#&gt; 14997:               0.37            0.53              2                  143</span></span>
<span><span class="co">#&gt; 14998:               0.11            0.96              6                  280</span></span>
<span><span class="co">#&gt; 14999:               0.37            0.52              2                  158</span></span>
<span><span class="co">#&gt;        time_spend_company Work_accident  left promotion_last_5years   sales</span></span>
<span><span class="co">#&gt;                     &lt;int&gt;         &lt;int&gt; &lt;int&gt;                 &lt;int&gt;  &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;     1:                  3             0     1                     0   sales</span></span>
<span><span class="co">#&gt;     2:                  6             0     1                     0   sales</span></span>
<span><span class="co">#&gt;     3:                  4             0     1                     0   sales</span></span>
<span><span class="co">#&gt;     4:                  5             0     1                     0   sales</span></span>
<span><span class="co">#&gt;     5:                  3             0     1                     0   sales</span></span>
<span><span class="co">#&gt;    ---                                                                     </span></span>
<span><span class="co">#&gt; 14995:                  3             0     1                     0 support</span></span>
<span><span class="co">#&gt; 14996:                  3             0     1                     0 support</span></span>
<span><span class="co">#&gt; 14997:                  3             0     1                     0 support</span></span>
<span><span class="co">#&gt; 14998:                  4             0     1                     0 support</span></span>
<span><span class="co">#&gt; 14999:                  3             0     1                     0 support</span></span>
<span><span class="co">#&gt;        salary</span></span>
<span><span class="co">#&gt;        &lt;fctr&gt;</span></span>
<span><span class="co">#&gt;     1:    low</span></span>
<span><span class="co">#&gt;     2: medium</span></span>
<span><span class="co">#&gt;     3: medium</span></span>
<span><span class="co">#&gt;     4:    low</span></span>
<span><span class="co">#&gt;     5:    low</span></span>
<span><span class="co">#&gt;    ---       </span></span>
<span><span class="co">#&gt; 14995:    low</span></span>
<span><span class="co">#&gt; 14996:    low</span></span>
<span><span class="co">#&gt; 14997:    low</span></span>
<span><span class="co">#&gt; 14998:    low</span></span>
<span><span class="co">#&gt; 14999:    low</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://harrison4192.github.io/validata/reference/diagnose_category.html" class="external-link">diagnose_category</a></span><span class="op">(</span>max_distinct <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 4</span></span></span>
<span><span class="co">#&gt;    column level           n  ratio</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> sales  sales        <span style="text-decoration: underline;">4</span>140 0.276 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> sales  technical    <span style="text-decoration: underline;">2</span>720 0.181 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> sales  support      <span style="text-decoration: underline;">2</span>229 0.149 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> sales  IT           <span style="text-decoration: underline;">1</span>227 0.081<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> sales  product_mng   902 0.060<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> sales  marketing     858 0.057<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> sales  RandD         787 0.052<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> sales  accounting    767 0.051<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> sales  hr            739 0.049<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> sales  management    630 0.042<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> salary low          <span style="text-decoration: underline;">7</span>316 0.488 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> salary medium       <span style="text-decoration: underline;">6</span>446 0.430 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> salary high         <span style="text-decoration: underline;">1</span>237 0.082<span style="text-decoration: underline;">5</span></span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://harrison4192.github.io/validata/reference/diagnose_numeric.html" class="external-link">diagnose_numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 11</span></span></span>
<span><span class="co">#&gt;   variables  zeros minus  infs   min    mean   max `|x|&lt;1 (ratio)` integer_ratio</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> satisfact…     0     0     0  0.09 6.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1           0.993       0.007<span style="text-decoration: underline;">40</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> last_eval…     0     0     0  0.36 7.16<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1           0.981       0.018<span style="text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> number_pr…     0     0     0  2    3.80<span style="color: #949494;">e</span>+0     7           0           1      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> average_m…     0     0     0 96    2.01<span style="color: #949494;">e</span>+2   310           0           1      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> time_spen…     0     0     0  2    3.50<span style="color: #949494;">e</span>+0    10           0           1      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Work_acci… <span style="text-decoration: underline;">12</span>830     0     0  0    1.45<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1           0.855       1      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> left       <span style="text-decoration: underline;">11</span>428     0     0  0    2.38<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>     1           0.762       1      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> promotion… <span style="text-decoration: underline;">14</span>680     0     0  0    2.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>     1           0.979       1      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: mode &lt;dbl&gt;, mode_ratio &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="xgboost-binary-classification-model">xgboost binary classification model<a class="anchor" aria-label="anchor" href="#xgboost-binary-classification-model"></a>
</h2>
<p>Create dummy variables out of the Sales and Salary column. We will
predict whether an employee left the company using xgboost. For this
reason, set <code>left = 1</code> to the first level of the factor, so
it will be treated as the event class. A high predicted indicates a
label of the event class.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">HR_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">framecleaner</span><span class="fu">::</span><span class="fu"><a href="https://harrison4192.github.io/framecleaner/reference/create_dummies.html" class="external-link">create_dummies</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">framecleaner</span><span class="fu">::</span><span class="fu"><a href="https://harrison4192.github.io/framecleaner/reference/set_fct.data.frame.html" class="external-link">set_fct</a></span><span class="op">(</span><span class="va">left</span>, first_level <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hr1</span></span></code></pre></div>
<p>Create the model using xgboost. Since the goal of this model is to
run inference using trees, we want to set tree_depth to 2 to make
easily-interpretable trees.</p>
<p>When the model is run, feature importance on the full data is
printed. Also the data is split into train and test, where the accuracy
is calculated on a test set. Since this is a binary classification
problem, a confusion matrix is output along with binary metrics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidy_formula</span><span class="op">(</span><span class="va">left</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hrf</span></span>
<span></span>
<span><span class="va">hr1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidy_xgboost</span><span class="op">(</span><span class="va">hrf</span>, tree_depth <span class="op">=</span> <span class="fl">2L</span>, trees <span class="op">=</span> <span class="fl">100L</span>, mtry <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">xg1</span></span></code></pre></div>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 × 3</span></span></span>
<span><span class="co">#&gt;    .metric              .estimate .formula              </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> accuracy                 0.934 TP + TN / total       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> kap                      0.806 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> sens                     0.780 TP / actually P       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> spec                     0.981 TN / actually N       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ppv                      0.928 TP / predicted P      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> npv                      0.935 TN / predicted N      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mcc                      0.811 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> j_index                  0.762 <span style="color: #BB0000;">NA</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> bal_accuracy             0.881 sens + spec / 2       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> detection_prevalence     0.198 predicted P / total   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> precision                0.928 PPV, 1-FDR            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> recall                   0.780 sens, TPR             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> f_meas                   0.848 HM(ppv, sens)         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> baseline_accuracy        0.764 majority class / total</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> roc_auc                  0.975 <span style="color: #BB0000;">NA</span></span></span></code></pre>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
<p>This line will save the tree structure of the model as a table.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xg1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.model.dt.tree.html" class="external-link">xgb.model.dt.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">.</span><span class="op">)</span>  <span class="op">-&gt;</span> <span class="va">xg_trees</span></span>
<span></span>
<span><span class="va">xg_trees</span></span>
<span><span class="co">#&gt;       Tree  Node     ID            Feature Split    Yes     No Missing</span></span>
<span><span class="co">#&gt;      &lt;int&gt; &lt;int&gt; &lt;char&gt;             &lt;char&gt; &lt;num&gt; &lt;char&gt; &lt;char&gt;  &lt;char&gt;</span></span>
<span><span class="co">#&gt;   1:     0     0    0-0 satisfaction_level 0.465    0-1    0-2     0-1</span></span>
<span><span class="co">#&gt;   2:     0     1    0-1     number_project 2.500    0-3    0-4     0-3</span></span>
<span><span class="co">#&gt;   3:     0     2    0-2    last_evaluation 0.825    0-5    0-6     0-5</span></span>
<span><span class="co">#&gt;   4:     0     3    0-3               Leaf    NA   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;   5:     0     4    0-4               Leaf    NA   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  ---                                                                  </span></span>
<span><span class="co">#&gt; 624:    99     2   99-2 satisfaction_level 0.715   99-5   99-6    99-5</span></span>
<span><span class="co">#&gt; 625:    99     3   99-3               Leaf    NA   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 626:    99     4   99-4               Leaf    NA   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 627:    99     5   99-5               Leaf    NA   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 628:    99     6   99-6               Leaf    NA   &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;</span></span>
<span><span class="co">#&gt;            Quality     Cover</span></span>
<span><span class="co">#&gt;              &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt;   1: 2292.12305000 2818.5000</span></span>
<span><span class="co">#&gt;   2:  680.09655800  784.0000</span></span>
<span><span class="co">#&gt;   3:  348.69824200 2034.5000</span></span>
<span><span class="co">#&gt;   4:    0.07575618  323.5000</span></span>
<span><span class="co">#&gt;   5:   -0.01875271  460.5000</span></span>
<span><span class="co">#&gt;  ---                        </span></span>
<span><span class="co">#&gt; 624:  127.58088700  334.8139</span></span>
<span><span class="co">#&gt; 625:    0.01482613  329.4183</span></span>
<span><span class="co">#&gt; 626:   -0.02640105  456.9404</span></span>
<span><span class="co">#&gt; 627:   -0.01077674  181.7939</span></span>
<span><span class="co">#&gt; 628:    0.05104293  153.0200</span></span></code></pre></div>
<p>Let’s plot the first tree and interpret the table output. For tree=0,
the root feature (node=0) is satisfaction level, which is split at value
.465. Is satisfaction_level &lt; .465? If Yes, observations go left to
node 1, if no, observations go right to node 2. Na values would go to
node 1 if present. The quality of the split is represented by its Gain:
3123, the improvement in training loss.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.plot.tree.html" class="external-link">xgb.plot.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">xg1</span>, trees <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 0\nsatisfaction_level\nCover: 2818.5\nGain: 2292.12305\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"2\" [label = \"number_project\nCover: 784\nGain: 680.096558\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"3\" [label = \"last_evaluation\nCover: 2034.5\nGain: 348.698242\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"4\" [label = \"Leaf\nCover: 323.5\nValue: 0.0757561773\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"5\" [label = \"Leaf\nCover: 460.5\nValue: -0.0187527128\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"6\" [label = \"Leaf\nCover: 1309\nValue: -0.095757924\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"7\" [label = \"Leaf\nCover: 725.5\nValue: -0.0524724536\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n\"1\"->\"2\" [label = \"< 0.465000004\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 2.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 0.824999988\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>The quality in the leaves is the prediction for observations in those
leaves represented by log odds. To interpret them as probabilities, use
the function below. Importantly, a log odds of 0 is a 0.5
probability.</p>
<div class="float">
<img src=".%5Csigmoidfunction.png" alt="sigmoid curve: logit function"><div class="figcaption">sigmoid curve: logit function</div>
</div>
</div>
<div class="section level2">
<h2 id="analyze-interactions">Analyze interactions<a class="anchor" aria-label="anchor" href="#analyze-interactions"></a>
</h2>
<p>In xgboost, an interaction occurs when the downstream split has a
higher gain than the upstream split.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># write the function collapse_tree to convert the tree output to interactions that occur in the tree.</span></span>
<span></span>
<span><span class="va">collapse_tree</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t1</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="va">t1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Tree</span>,  Root_Feature <span class="op">=</span> <span class="va">Feature</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span></span>
<span>    <span class="va">t1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Child1 <span class="op">=</span> <span class="va">Feature</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span></span>
<span>    <span class="va">t1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>Child2 <span class="op">=</span> <span class="va">Feature</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"interaction1"</span>, <span class="va">Root_Feature</span>, <span class="va">Child1</span>, sep <span class="op">=</span> <span class="st">":"</span>, remove <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Child1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html" class="external-link">unite</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"interaction2"</span>, <span class="va">Root_Feature</span>, <span class="va">Child2</span>, sep <span class="op">=</span> <span class="st">":"</span>, remove <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"names"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"interaction"</span><span class="op">)</span>, values_to <span class="op">=</span> <span class="st">"interactions"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">names</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">xg_trees</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">collapse_tree</span> <span class="op">-&gt;</span> <span class="va">xg_trees_interactions</span></span></code></pre></div>
<p>find the top interactions in the model. The interactions are rated
with different importance metrics, ordered by sumGain.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">imps</span> <span class="op">&lt;-</span> <span class="fu">EIX</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EIX/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">xg1</span>, <span class="va">hr1</span>, option <span class="op">=</span> <span class="st">"interactions"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">imps</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">set_int</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 17 × 7</span></span></span>
<span><span class="co">#&gt;    Feature               sumGain sumCover meanGain meanCover frequency mean5Gain</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> satisfaction_level:n…    <span style="text-decoration: underline;">5</span>232    <span style="text-decoration: underline;">22</span>360      402      <span style="text-decoration: underline;">1</span>720        13       611</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> number_project:satis…    <span style="text-decoration: underline;">4</span>141     <span style="text-decoration: underline;">8</span>347      690      <span style="text-decoration: underline;">1</span>391         6       802</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> time_spend_company:s…    <span style="text-decoration: underline;">3</span>134     <span style="text-decoration: underline;">5</span>716      783      <span style="text-decoration: underline;">1</span>429         4       783</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> average_montly_hours…    <span style="text-decoration: underline;">2</span>407     <span style="text-decoration: underline;">6</span>255      343       893         7       411</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> last_evaluation:time…    <span style="text-decoration: underline;">2</span>333     <span style="text-decoration: underline;">3</span>709      388       618         6       448</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> satisfaction_level:t…    <span style="text-decoration: underline;">2</span>213     <span style="text-decoration: underline;">6</span>753      442      <span style="text-decoration: underline;">1</span>351         5       442</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> number_project:time_…    <span style="text-decoration: underline;">2</span>173     <span style="text-decoration: underline;">5</span>587      724      <span style="text-decoration: underline;">1</span>862         3       724</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> average_montly_hours…    <span style="text-decoration: underline;">1</span>434     <span style="text-decoration: underline;">1</span>780      478       593         3       478</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> last_evaluation:sati…    <span style="text-decoration: underline;">1</span>162     <span style="text-decoration: underline;">5</span>995      193       999         6       213</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> last_evaluation:numb…    <span style="text-decoration: underline;">1</span>018     <span style="text-decoration: underline;">5</span>364      203      <span style="text-decoration: underline;">1</span>073         5       203</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> number_project:avera…     864     <span style="text-decoration: underline;">1</span>579      288       526         3       288</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> average_montly_hours…     444      620      444       620         1       444</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> number_project:last_…     213      371      213       371         1       213</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> time_spend_company:l…     211     <span style="text-decoration: underline;">1</span>352      211      <span style="text-decoration: underline;">1</span>352         1       211</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> satisfaction_level:W…      99     <span style="text-decoration: underline;">1</span>203       99      <span style="text-decoration: underline;">1</span>203         1        99</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> Work_accident:time_s…      92     <span style="text-decoration: underline;">1</span>077       92      <span style="text-decoration: underline;">1</span>077         1        92</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> average_montly_hours…      88     <span style="text-decoration: underline;">1</span>172       88      <span style="text-decoration: underline;">1</span>172         1        88</span></span></code></pre></div>
<p>We can extract all the trees that contain the specified
interaction.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">imps</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unlist</span> <span class="op">-&gt;</span> <span class="va">top_interaction</span></span>
<span></span>
<span></span>
<span><span class="va">xg_trees_interactions</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">interactions</span>, <span class="va">top_interaction</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="va">distinct</span> <span class="op">-&gt;</span> <span class="va">top_interaction_trees</span></span>
<span></span>
<span><span class="va">top_interaction_trees</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 2</span></span></span>
<span><span class="co">#&gt;     Tree interactions                     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     0 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     3 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     4 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     6 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     8 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    14 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    17 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    18 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    19 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    23 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    24 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    26 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>    27 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>    29 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>    30 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>    31 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>    34 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>    37 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>    46 satisfaction_level:number_project</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>    63 satisfaction_level:number_project</span></span></code></pre></div>
<p>Then extract the first 3 (most important) trees and print them.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_interaction_trees</span><span class="op">$</span><span class="va">Tree</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">trees_index</span></span>
<span></span>
<span></span>
<span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.plot.tree.html" class="external-link">xgb.plot.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">xg1</span>, trees <span class="op">=</span> <span class="va">trees_index</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 4\nsatisfaction_level\nCover: 2766.06689\nGain: 1545.01392\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"2\" [label = \"number_project\nCover: 764.425964\nGain: 512.124634\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"3\" [label = \"time_spend_company\nCover: 2001.64087\nGain: 862.131836\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"4\" [label = \"Leaf\nCover: 315.400177\nValue: 0.0647574738\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"5\" [label = \"Leaf\nCover: 449.025757\nValue: -0.0182922166\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"6\" [label = \"Leaf\nCover: 1629.13464\nValue: -0.0832394511\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"7\" [label = \"Leaf\nCover: 372.506226\nValue: 0.00105521514\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"8\" [label = \"Tree 3\nsatisfaction_level\nCover: 2800.27808\nGain: 1836.93506\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"9\" [label = \"number_project\nCover: 776.566833\nGain: 556.048706\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"10\" [label = \"time_spend_company\nCover: 2023.7113\nGain: 977.536377\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"11\" [label = \"Leaf\nCover: 326.556793\nValue: 0.0696036369\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"12\" [label = \"Leaf\nCover: 450.010071\nValue: -0.0160269476\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"13\" [label = \"Leaf\nCover: 1655.54944\nValue: -0.086821869\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"14\" [label = \"Leaf\nCover: 368.161865\nValue: 0.00323310797\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"15\" [label = \"Tree 0\nsatisfaction_level\nCover: 2818.5\nGain: 2292.12305\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"16\" [label = \"number_project\nCover: 784\nGain: 680.096558\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"17\" [label = \"last_evaluation\nCover: 2034.5\nGain: 348.698242\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"18\" [label = \"Leaf\nCover: 323.5\nValue: 0.0757561773\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"19\" [label = \"Leaf\nCover: 460.5\nValue: -0.0187527128\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"20\" [label = \"Leaf\nCover: 1309\nValue: -0.095757924\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"21\" [label = \"Leaf\nCover: 725.5\nValue: -0.0524724536\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n\"1\"->\"2\" [label = \"< 0.465000004\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 2.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 4.5\", style = \"bold\"] \n\"8\"->\"9\" [label = \"< 0.465000004\", style = \"bold\"] \n\"9\"->\"11\" [label = \"< 2.5\", style = \"bold\"] \n\"10\"->\"13\" [label = \"< 4.5\", style = \"bold\"] \n\"15\"->\"16\" [label = \"< 0.465000004\", style = \"bold\"] \n\"16\"->\"18\" [label = \"< 2.5\", style = \"bold\"] \n\"17\"->\"20\" [label = \"< 0.824999988\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n\"8\"->\"10\" [style = \"solid\", style = \"solid\"] \n\"9\"->\"12\" [style = \"solid\", style = \"solid\"] \n\"10\"->\"14\" [style = \"solid\", style = \"solid\"] \n\"15\"->\"17\" [style = \"solid\", style = \"solid\"] \n\"16\"->\"19\" [style = \"solid\", style = \"solid\"] \n\"17\"->\"21\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>We can confirm they are interactions because the child leaf in the
interaction has higher split gain than the root leaf.</p>
</div>
<div class="section level2">
<h2 id="analyze-single-features">Analyze single features<a class="anchor" aria-label="anchor" href="#analyze-single-features"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># EIX package gives more detailed importances than the standard xgboost package</span></span>
<span><span class="va">imps_single</span> <span class="op">&lt;-</span> <span class="fu">EIX</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EIX/man/importance.html" class="external-link">importance</a></span><span class="op">(</span><span class="va">xg1</span>, <span class="va">hr1</span>, option <span class="op">=</span> <span class="st">"variables"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># choose the top feature</span></span>
<span><span class="va">imps_single</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unlist</span> <span class="op">-&gt;</span> <span class="va">feature1</span></span>
<span></span>
<span><span class="co"># get the top 3 rees of the most important feature. Less complicated than with interactions so</span></span>
<span><span class="co"># no need to write a separate function like collapse tree</span></span>
<span><span class="va">xg_trees</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Node</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="va">ungroup</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Feature</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">feature1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">Tree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="va">unlist</span> <span class="op">-&gt;</span> <span class="va">top_trees</span></span>
<span></span>
<span><span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.plot.tree.html" class="external-link">xgb.plot.tree</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">xg1</span>, trees <span class="op">=</span> <span class="va">top_trees</span><span class="op">)</span></span></code></pre></div>
<div class="grViz html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"diagram":"digraph {\n\ngraph [layout = \"dot\",\n       rankdir = \"LR\"]\n\nnode [color = \"DimGray\",\n      style = \"filled\",\n      fontname = \"Helvetica\"]\n\nedge [color = \"DimGray\",\n     arrowsize = \"1.5\",\n     arrowhead = \"vee\",\n     fontname = \"Helvetica\"]\n\n  \"1\" [label = \"Tree 3\nsatisfaction_level\nCover: 2800.27808\nGain: 1836.93506\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"2\" [label = \"number_project\nCover: 776.566833\nGain: 556.048706\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"3\" [label = \"time_spend_company\nCover: 2023.7113\nGain: 977.536377\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"4\" [label = \"Leaf\nCover: 326.556793\nValue: 0.0696036369\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"5\" [label = \"Leaf\nCover: 450.010071\nValue: -0.0160269476\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"6\" [label = \"Leaf\nCover: 1655.54944\nValue: -0.086821869\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"7\" [label = \"Leaf\nCover: 368.161865\nValue: 0.00323310797\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"8\" [label = \"Tree 1\nsatisfaction_level\nCover: 2793.54175\nGain: 2033.15576\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"9\" [label = \"satisfaction_level\nCover: 779.504272\nGain: 571.812012\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"10\" [label = \"last_evaluation\nCover: 2014.03748\nGain: 298.830566\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"11\" [label = \"Leaf\nCover: 163.984253\nValue: 0.100581326\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"12\" [label = \"Leaf\nCover: 615.52002\nValue: -0.00432202732\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"13\" [label = \"Leaf\nCover: 1292.78406\nValue: -0.0916819721\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"14\" [label = \"Leaf\nCover: 721.253418\nValue: -0.0514397733\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"15\" [label = \"Tree 0\nsatisfaction_level\nCover: 2818.5\nGain: 2292.12305\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"16\" [label = \"number_project\nCover: 784\nGain: 680.096558\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"17\" [label = \"last_evaluation\nCover: 2034.5\nGain: 348.698242\", fillcolor = \"Beige\", shape = \"rectangle\", fontcolor = \"black\"] \n  \"18\" [label = \"Leaf\nCover: 323.5\nValue: 0.0757561773\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"19\" [label = \"Leaf\nCover: 460.5\nValue: -0.0187527128\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"20\" [label = \"Leaf\nCover: 1309\nValue: -0.095757924\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n  \"21\" [label = \"Leaf\nCover: 725.5\nValue: -0.0524724536\", fillcolor = \"Khaki\", shape = \"oval\", fontcolor = \"black\"] \n\"1\"->\"2\" [label = \"< 0.465000004\", style = \"bold\"] \n\"2\"->\"4\" [label = \"< 2.5\", style = \"bold\"] \n\"3\"->\"6\" [label = \"< 4.5\", style = \"bold\"] \n\"8\"->\"9\" [label = \"< 0.465000004\", style = \"bold\"] \n\"9\"->\"11\" [label = \"< 0.114999995\", style = \"bold\"] \n\"10\"->\"13\" [label = \"< 0.824999988\", style = \"bold\"] \n\"15\"->\"16\" [label = \"< 0.465000004\", style = \"bold\"] \n\"16\"->\"18\" [label = \"< 2.5\", style = \"bold\"] \n\"17\"->\"20\" [label = \"< 0.824999988\", style = \"bold\"] \n\"1\"->\"3\" [style = \"bold\", style = \"solid\"] \n\"2\"->\"5\" [style = \"solid\", style = \"solid\"] \n\"3\"->\"7\" [style = \"solid\", style = \"solid\"] \n\"8\"->\"10\" [style = \"solid\", style = \"solid\"] \n\"9\"->\"12\" [style = \"solid\", style = \"solid\"] \n\"10\"->\"14\" [style = \"solid\", style = \"solid\"] \n\"15\"->\"17\" [style = \"solid\", style = \"solid\"] \n\"16\"->\"19\" [style = \"solid\", style = \"solid\"] \n\"17\"->\"21\" [style = \"solid\", style = \"solid\"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p>By looking at the 3 most important splits for satisfaction_level we
can get a sense of how its splits affect the outcome.</p>
</div>
<div class="section level2">
<h2 id="shapley-values">shapley values<a class="anchor" aria-label="anchor" href="#shapley-values"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xg1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidy_shap</span><span class="op">(</span><span class="va">hr1</span>, form <span class="op">=</span> <span class="va">hrf</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">hr_shaps</span></span>
<span></span>
<span><span class="va">hr_shaps</span></span>
<span><span class="co">#&gt; $shap_tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14,999 × 20</span></span></span>
<span><span class="co">#&gt;    satisfaction_level last_evaluation number_project average_montly_hours</span></span>
<span><span class="co">#&gt;                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>              0.870          0.018<span style="text-decoration: underline;">4</span>          1.70                0.071<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>             -<span style="color: #BB0000;">0.317</span>          0.396          -<span style="color: #BB0000;">0.214</span>               0.222 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>              3.66           0.157          -<span style="color: #BB0000;">0.254</span>               0.199 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>             -<span style="color: #BB0000;">0.316</span>          0.396          -<span style="color: #BB0000;">0.246</span>               0.076<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>              0.870          0.018<span style="text-decoration: underline;">4</span>          1.70                0.071<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>              0.870          0.018<span style="text-decoration: underline;">4</span>          1.70                0.071<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>              3.73          -<span style="color: #BB0000;">0.174</span>          -<span style="color: #BB0000;">0.304</span>               0.173 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>             -<span style="color: #BB0000;">0.316</span>          0.396          -<span style="color: #BB0000;">0.214</span>               0.223 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>             -<span style="color: #BB0000;">0.297</span>          0.949          -<span style="color: #BB0000;">0.237</span>               0.088<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>              0.870          0.018<span style="text-decoration: underline;">4</span>          1.70                0.071<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14,989 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 16 more variables: time_spend_company &lt;dbl&gt;, Work_accident &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   promotion_last_5years &lt;dbl&gt;, sales_accounting &lt;dbl&gt;, sales_hr &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sales_it &lt;dbl&gt;, sales_management &lt;dbl&gt;, sales_marketing &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sales_product_mng &lt;dbl&gt;, sales_rand_d &lt;dbl&gt;, sales_sales &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sales_support &lt;dbl&gt;, sales_technical &lt;dbl&gt;, salary_high &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   salary_low &lt;dbl&gt;, salary_medium &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $shap_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt;    name                     cor     var     sum sum_abs</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> satisfaction_level    -<span style="color: #BB0000;">0.761</span> 1.13     -<span style="color: #BB0000;">854.</span>   <span style="text-decoration: underline;">11</span>395.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> number_project        -<span style="color: #BB0000;">0.580</span> 0.505   -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">233.</span>    <span style="text-decoration: underline;">8</span>515.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> time_spend_company     0.743 0.383   -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">615.</span>    <span style="text-decoration: underline;">7</span>237.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> last_evaluation        0.674 0.061<span style="text-decoration: underline;">0</span>   -<span style="color: #BB0000;">288.</span>    <span style="text-decoration: underline;">3</span>082.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> average_montly_hours   0.669 0.028<span style="text-decoration: underline;">5</span>    -<span style="color: #BB0000;">69.5</span>   <span style="text-decoration: underline;">2</span>029.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Work_accident         -<span style="color: #BB0000;">0.995</span> 0.007<span style="text-decoration: underline;">58</span>   -<span style="color: #BB0000;">87.0</span>    852.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> salary_low             0.981 0.001<span style="text-decoration: underline;">35</span>   -<span style="color: #BB0000;">27.3</span>    541.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> promotion_last_5years <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> salary_high           <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> salary_medium         <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> sales_accounting      <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> sales_hr              <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> sales_it              <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> sales_management      <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> sales_marketing       <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> sales_product_mng     <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> sales_rand_d          <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> sales_sales           <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> sales_support         <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> sales_technical       <span style="color: #BB0000;">NA</span>     0           0        0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $swarmplot</span></span></code></pre></div>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $scatterplots</span></span></code></pre>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-14-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $boxplots</span></span></code></pre>
<p><img src="Inference-with-xgboost_files/figure-html/unnamed-chunk-14-3.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="links">Links<a class="anchor" aria-label="anchor" href="#links"></a>
</h2>
<p><a href="https://modeloriented.github.io/EIX/articles/EIX.html" class="external-link">EIX
vignette using HR_data</a> <a href="https://xgboost.readthedocs.io/en/stable/tutorials/model.html" class="external-link">Introduction
to boosted trees</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Harrison Tietze.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
